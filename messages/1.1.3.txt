Sorry, I made several mistakes last time with the preprocessors. Things should be fixed now.
Again, you may notice that I highlight some of your preprocessor lines. This is intentional and meant to prevent programmers from messing up their comments.
